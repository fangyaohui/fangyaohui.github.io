<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>68 Netty | 孤岛</title><meta name="author" content="徐行"><meta name="copyright" content="徐行"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="68 Netty参考资料 【硬核】肝了一月的Netty知识点   概念Netty 是一个高性能、异步事件驱动的网络应用框架，简化了 Java 网络编程，适用于构建高效、可扩展的网络服务器和客户端。 Netty 是基于 Java NIO 的异步事件驱动的网络应用框架，使用 Netty 可以快速开发网络应用，Netty 提供了高层次的抽象来简化 TCP 和 UDP 服务器的编程，但是你仍然可以使用底层">
<meta property="og:type" content="article">
<meta property="og:title" content="68 Netty">
<meta property="og:url" content="http://example.com/2025/02/26/68%20Netty/index.html">
<meta property="og:site_name" content="孤岛">
<meta property="og:description" content="68 Netty参考资料 【硬核】肝了一月的Netty知识点   概念Netty 是一个高性能、异步事件驱动的网络应用框架，简化了 Java 网络编程，适用于构建高效、可扩展的网络服务器和客户端。 Netty 是基于 Java NIO 的异步事件驱动的网络应用框架，使用 Netty 可以快速开发网络应用，Netty 提供了高层次的抽象来简化 TCP 和 UDP 服务器的编程，但是你仍然可以使用底层">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/11.png">
<meta property="article:published_time" content="2025-02-26T10:58:17.000Z">
<meta property="article:modified_time" content="2025-02-27T07:38:55.178Z">
<meta property="article:author" content="徐行">
<meta property="article:tag" content="Netty">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/11.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "68 Netty",
  "url": "http://example.com/2025/02/26/68%20Netty/",
  "image": "http://example.com/img/11.png",
  "datePublished": "2025-02-26T10:58:17.000Z",
  "dateModified": "2025-02-27T07:38:55.178Z",
  "author": [
    {
      "@type": "Person",
      "name": "徐行",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/02/26/68%20Netty/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '68 Netty',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/11.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">孤岛</span></a><a class="nav-page-title" href="/"><span class="site-name">68 Netty</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">68 Netty</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-26T10:58:17.000Z" title="发表于 2025-02-26 18:58:17">2025-02-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-27T07:38:55.178Z" title="更新于 2025-02-27 15:38:55">2025-02-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Netty/">Netty</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="68-Netty"><a href="#68-Netty" class="headerlink" title="68 Netty"></a>68 Netty</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35190492/article/details/113174359?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522D07BDB48-FAA2-4E6E-86E3-A8188987EE2B%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=D07BDB48-FAA2-4E6E-86E3-A8188987EE2B&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-113174359-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=Netty&spm=1018.2226.3001.4187">【硬核】肝了一月的Netty知识点</a></li>
<li></li>
</ol>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p><strong>Netty 是一个高性能、异步事件驱动的网络应用框架</strong>，简化了 Java 网络编程，适用于构建高效、可扩展的网络服务器和客户端。</p>
<p>Netty 是基于 Java NIO 的异步事件驱动的网络应用框架，使用 Netty 可以快速开发网络应用，Netty 提供了高层次的抽象来简化 TCP 和 UDP 服务器的编程，但是你仍然可以使用底层的 API。</p>
<p>Netty是一个非阻塞的IO客户端服务器框架</p>
<p>阻塞（Block）与非阻塞（Non-Block）</p>
<ul>
<li><p>阻塞和非阻塞是进程在访问数据的时候，数据是否准备就绪的一种处理方式，当数据没有准备的时候。</p>
</li>
<li><p>阻塞：往往需要等待缓冲区中的数据准备好过后才处理其他的事情，否则一直等待在那里。</p>
</li>
<li><p>非阻塞:当我们的进程访问我们的数据缓冲区的时候，如果数据没有准备好则直接返回，不会等待。如果数据已经准备好，也直接返回。</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/fangyaohui/Pictures@main/img/202502262018372.png" alt="image-20241010184412267"></p>
<ul>
<li><strong>Feign</strong> 是一个用于调用 RESTful API 的同步框架，调用方会被阻塞，直到接收到响应。在消息队列的场景中，生产者通常需要非阻塞地发送消息，以提高性能和吞吐量。</li>
</ul>
<h3 id="Netty-核心组件"><a href="#Netty-核心组件" class="headerlink" title="Netty 核心组件"></a>Netty 核心组件</h3><h4 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h4><p> Channel是 Java NIO 的一个基本构造。<strong>可以看作是传入或传出数据的载体</strong>。因此，它可以被打开或关闭，连接或者断开连接。</p>
<h4 id="EventLoop-与-EventLoopGroup"><a href="#EventLoop-与-EventLoopGroup" class="headerlink" title="EventLoop 与 EventLoopGroup"></a>EventLoop 与 EventLoopGroup</h4><p> EventLoop 定义了Netty的核心抽象，用来处理连接的生命周期中所发生的事件，在内部，将会为每<strong>个Channel分配一个EventLoop</strong>。</p>
<p> EventLoopGroup 是一个 EventLoop 池，包含很多的 EventLoop。</p>
<p> Netty 为每个 Channel 分配了一个 EventLoop，用于处理用户连接请求、对用户请求的处理等所有事件。<strong>EventLoop 本身只是一个线程驱动，在其生命周期内只会绑定一个线程，让该线程处理一个 Channel 的所有 IO 事件。</strong></p>
<p> 一个 Channel 一旦与一个 EventLoop 相绑定，那么在 Channel 的整个生命周期内是不能改变的。一个 EventLoop 可以与多个 Channel 绑定。即 Channel 与 EventLoop 的关系是 n:1，而 EventLoop 与线程的关系是 1:1。</p>
<h4 id="ServerBootstrap-与-Bootstrap"><a href="#ServerBootstrap-与-Bootstrap" class="headerlink" title="ServerBootstrap 与 Bootstrap"></a>ServerBootstrap 与 Bootstrap</h4><p> Bootstarp 和 ServerBootstrap 被称为引导类，指对应用程序进行配置，并使他运行起来的过程。Netty处理引导的方式是使你的应用程序和网络层相隔离。</p>
<p> Bootstrap 是客户端的引导类，Bootstrap 在调用 bind()（连接UDP）和 connect()（连接TCP）方法时，会新创建一个 Channel，仅创建一个单独的、没有父 Channel 的 Channel 来实现所有的网络交换。</p>
<p> <strong>ServerBootstrap 是服务端的引导类，ServerBootstarp 在调用 bind() 方法时会创建一个 ServerChannel 来接受来自客户端的连接，并且该 ServerChannel 管理了多个子 Channel 用于同客户端之间的通信。</strong></p>
<h4 id="ChannelHandler-与-ChannelPipeline"><a href="#ChannelHandler-与-ChannelPipeline" class="headerlink" title="ChannelHandler 与 ChannelPipeline"></a>ChannelHandler 与 ChannelPipeline</h4><p> ChannelHandler 是对 Channel 中数据的处理器，这些处理器可以是系统本身定义好的编解码器，也可以是用户自定义的。这些处理器会被统一添加到一个 ChannelPipeline 的对象中，然后按照添加的顺序对 Channel 中的数据进行依次处理。</p>
<h4 id="ChannelFuture"><a href="#ChannelFuture" class="headerlink" title="ChannelFuture"></a>ChannelFuture</h4><p> Netty 中所有的 I&#x2F;O 操作都是异步的，即操作不会立即得到返回结果，所以 Netty 中定义了一个 ChannelFuture 对象作为这个异步操作的“代言人”，表示异步操作本身。如果想获取到该异步操作的返回值，可以通过该异步操作对象的addListener() 方法为该异步操作添加监 NIO 网络编程框架 Netty 听器，为其注册回调：当结果出来后马上调用执行。</p>
<p> Netty 的异步编程模型都是建立在 Future 与回调概念之上的。</p>
<h3 id="心跳"><a href="#心跳" class="headerlink" title="心跳"></a>心跳</h3><p>因为 Netty 建立的是<strong>长连接</strong>，也就是说只要不在 Client 的代码中手动 <code>channel.close();</code> 那该连接就会一直保持着，直到客户端或者服务器一方关闭。</p>
<p>也不是说长连接它就不好，但大家想想，每一个客户端都一直占着一个连接，即使它后面已经用不到服务器了，而服务器能承受的连接数是有限的，后面再来了真正有需求的用户，它也进不来了，而且长时间的高并发也可能导致服务器宕机。</p>
<p>所以，有没有一种办法，如果我一段时间用不到服务器，就把这个连接给关掉？答：心跳机制。所谓心跳，即在 TCP 长连接中，客户端和服务器之间定期发送的一种特殊的数据包（比如消息内容是某种要求格式、内容），通知对方自己还在线，以确保 TCP 连接的有效性。</p>
<p>在 Netty 中，实现心跳机制的关键是 IdleStateHandler（空闲状态处理器），它的作用跟名字一样，是用来监测连接的空闲情况。然后我们就可以根据心跳情况，来实现具体的处理逻辑，比如说断开连接、重新连接等等。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Netty 是一个高性能的<strong>异步事件驱动</strong>的网络应用框架，广泛用于开发网络应用程序，如协议服务器和客户端。简单来说这个框架是基于<strong>异步事件驱动</strong>的网络应用框架，这里最重要的一个点是事件驱动。</p>
<p>何为事件驱动呢？事件驱动就是指它的服务逻辑都是针对发生的事件来触发的，一旦某个事件发生了，就会触发该时间的处理逻辑。比如建立连接、数据读取、数据写入等等情况。</p>
<p>该应用框架总体来说就是为了两个服务直接进行通信，只不过这个是异步通信，而不是像之前那样的同步通信，它是非阻塞的，具有很高的性能。那么连接两个节点之间进行通信的称为<strong>通道</strong>（<strong>Channel</strong>），通过这个通道来实现双方之间的通信。这些都是应用层面的，对于传输层来说，具体使用的是TCP协议还是UDP协议都做了适配。</p>
<p><strong>ChannelHandler</strong> 是处理特定事件和数据的组件。你可以定义自己的 ChannelHandler，重写方法来处理数据的编解码、连接的生命周期事件、异常处理等。这个可以看成通道上的管理人员，我们可以在通道的两头编写的自定义的入站和出站逻辑。</p>
<p>在网络通信中，数据通常需要进行<strong>编码和解码</strong>。在 Netty 中，编解码的过程通过 <code>ChannelHandler</code> 的实现来完成。Netty 提供了 <code>MessageToByteEncoder</code> 和 <code>ByteToMessageDecoder</code> 等抽象类，简化了这一过程。</p>
<p><strong>ChannelPipeline</strong> 是一个关键概念，它允许开发者将多个 ChannelHandler 组合在一起，形成一个<strong>处理链</strong>。当数据在 Channel 中流动时，它会依次经过链中的每个处理器。这种设计使得数据的处理过程可以灵活配置，支持不同的协议和业务逻辑。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyServerHandlerInitializer</span> <span class="keyword">extends</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        ch.pipeline()</span><br><span class="line">                <span class="comment">//空闲检测</span></span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ServerIdleStateHandler</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufVarint32FrameDecoder</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufDecoder</span>(MessageBase.Message.getDefaultInstance()))</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufVarint32LengthFieldPrepender</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufEncoder</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">NettyServerHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里就是一个ChannelPipeline。</p>
<p><strong>Reactor模型</strong>是Netty采用的线程模型，下面是其一个图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/fangyaohui/Pictures@main/img/202502262019297.png" alt="image-20241011195241906"></p>
<p>Netty 的线程模型基于 <strong>Reactor</strong> 模式，这种模式特别适合于处理大量的并发连接。<strong>Reactor 模式的基本思路是将 I&#x2F;O 操作与业务逻辑处理分离，将 I&#x2F;O 事件的处理和业务逻辑处理分配给不同的线程</strong>。</p>
<p><strong>事件循环</strong>: 每个 EventLoop 会不断地循环处理事件，包括连接事件、读事件和写事件。EventLoop 负责从操作系统获取可读或可写的 Channel，并将这些事件分发给对应的 ChannelHandler 进行处理。</p>
<p>Netty的处理架构如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/fangyaohui/Pictures@main/img/202502262019692.png" alt="image-20241011195650688"></p>
<p>Netty主要在Reactor的主从模型上进行了一些改进后得到了目前Netty使用的Reactor模型。</p>
<p><img src="https://cdn.jsdelivr.net/gh/fangyaohui/Pictures@main/img/202502262019433.png" alt="image-20241011195844135"></p>
<h3 id="Netty工作原理"><a href="#Netty工作原理" class="headerlink" title="Netty工作原理"></a>Netty工作原理</h3><p>参考资料：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40909461/article/details/138355959?ops_request_misc=%257B%2522request%255Fid%2522%253A%25221B4F5303-2934-4300-B3BE-9463B4F2B8F5%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=1B4F5303-2934-4300-B3BE-9463B4F2B8F5&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-138355959-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=Netty%E6%9E%B6%E6%9E%84&spm=1018.2226.3001.4187">【Netty系列】Netty高性能架构设计以及光速入门</a></p>
<p>一图见真知</p>
<p><img src="https://cdn.jsdelivr.net/gh/fangyaohui/Pictures@main/img/202502262019540.png" alt="image-20241011200020959"></p>
<p>Netty 抽象出了两组线程池BossGroup和WorkerGroup，<strong>其中BossGroup专门负责接受客户端的连接</strong>，<strong>WorkerGroup专门负责网络的读写</strong>。BossGroup和WorkerGroup的类型都是NioEventLoopGroup。NioEventLoopGroup相当于一个事件循环组，这个组种含有多个事件循环，每一个事件循环是一个NioEventLoop。NioEeventLoop表示一个不断循环执行处理任务的线程，可以有多个线程，也就是说可以含有多个NioEventLoop，每个NioEventLoop都有一个Selector，用于监听绑定在其上的socket的网络通讯。</p>
<p><strong>EventLoop 和 EventLoopGroup</strong>：<code>EventLoop</code> 是 Netty 的事件循环，它处理 Channel 上的所有事件，包括 I&#x2F;O 事件、任务调度等。每个 <code>EventLoop</code> 负责处理一个或多个 <code>Channel</code>，确保同一个 <code>Channel</code> 的所有 I&#x2F;O 操作都在同一个线程中执行，避免线程安全问题。<code>EventLoopGroup</code> 是 <code>EventLoop</code> 的集合，通常分为两类：</p>
<ul>
<li><strong>BossGroup</strong>：负责处理新的连接请求。</li>
<li><strong>WorkerGroup</strong>：负责处理已经建立的连接的 I&#x2F;O 操作。</li>
</ul>
<p><strong>Bootstrap&#x2F;ServerBootstrap</strong>：用于启动 Netty 应用程序的辅助类。<code>Bootstrap</code> 用于客户端，<code>ServerBootstrap</code> 用于服务器。它们简化了配置和初始化过程。</p>
<h2 id="SpringBoot集成Netty"><a href="#SpringBoot集成Netty" class="headerlink" title="SpringBoot集成Netty"></a>SpringBoot集成Netty</h2><p>参考资料</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1620776">Springboot 2.0 +protobuf + Netty 实战(附源码)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/li371518473/article/details/136572133">Spring Boot与Netty的完美结合：打造高性能网络通信</a></li>
</ul>
<h3 id="protobuf协议格式"><a href="#protobuf协议格式" class="headerlink" title="protobuf协议格式"></a>protobuf协议格式</h3><p>在整合使用 Netty 的过程中，我们使用 Google 的protobuf定义消息格式，下面来简单介绍下 protobuf。</p>
<p>了解一个新的事物，我们从这几个方面快速的了解：</p>
<ul>
<li>它是什么？Protobuf是一个数据格式，专业术语为：一种结构化数据存储格式；</li>
<li>它有什么用？通常用于结构化数据的序列化和反序列化；</li>
<li>它相比较之前存在的有什么优点？解决了什么问题？它相对于JSON来说，性能更好，支持跨语言（因为它最后是二进制格式的数据编码）</li>
</ul>
<p>通过上面三个问题就可以对Protobuf有一个初步清晰的了解。</p>
<h3 id="引入Netty依赖"><a href="#引入Netty依赖" class="headerlink" title="引入Netty依赖"></a>引入Netty依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.netty/netty-all --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.112.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Netty服务端"><a href="#Netty服务端" class="headerlink" title="Netty服务端"></a>Netty服务端</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyServer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * boss 线程组用于处理连接工作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">EventLoopGroup</span> <span class="variable">boss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**在</span></span><br><span class="line"><span class="comment">     * work 线程组用于数据处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">EventLoopGroup</span> <span class="variable">work</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Value(&quot;$&#123;netty.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">54021</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// @PostConstruct 是一个用于 Java EE 和 Spring 框架中的注解，标记在一个方法上，表示这个方法将在依赖注入完成后被自动调用。</span></span><br><span class="line">    <span class="comment">// 它通常用于进行初始化操作，例如设置默认值、执行启动时的逻辑、或者进行资源的准备。</span></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span> 启动Netty Server</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span>  &#125;</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span> yaoHui</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span> 2024/10/10</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">        serverBootstrap.group(boss,work)</span><br><span class="line">                <span class="comment">// 指定Channel</span></span><br><span class="line">                .channel(NioServerSocketChannel.class)</span><br><span class="line">                <span class="comment">//使用指定的端口设置套接字地址</span></span><br><span class="line">                .localAddress(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(port))</span><br><span class="line">                <span class="comment">// 方法设置了 Socket 选项 SO_BACKLOG，它指定了在连接队列中可以排队的最大连接数。当服务器正在处理现有连接时，</span></span><br><span class="line">                <span class="comment">// 新的连接请求会被放入队列中，直到当前连接处理完成。1024 是队列的长度，这个值可以根据需要进行调整。</span></span><br><span class="line">                .option(ChannelOption.SO_BACKLOG,<span class="number">1024</span>)</span><br><span class="line">                <span class="comment">// 设置 SO_KEEPALIVE 选项为 true，这意味着在 TCP 连接上启用 TCP 保活机制。</span></span><br><span class="line">                <span class="comment">// 如果连接闲置时间过长，系统会发送保活探测包，以保持连接的活跃状态。</span></span><br><span class="line">                .childOption(ChannelOption.SO_KEEPALIVE,<span class="literal">true</span>)</span><br><span class="line">                <span class="comment">// 设置 TCP_NODELAY 选项为 true，启用 Nagle 算法。</span></span><br><span class="line">                <span class="comment">// 这会在发送小数据包时禁用延迟，从而减少数据包的发送延迟，提高实时性。</span></span><br><span class="line">                .childOption(ChannelOption.TCP_NODELAY,<span class="literal">true</span>)</span><br><span class="line">                .childHandler(<span class="keyword">new</span> <span class="title class_">NettyServerHandlerInitializer</span>());</span><br><span class="line">        <span class="type">ChannelFuture</span> <span class="variable">future</span> <span class="operator">=</span> serverBootstrap.bind().sync();</span><br><span class="line">        <span class="keyword">if</span> (future.isSuccess())&#123;</span><br><span class="line">            log.info(<span class="string">&quot;Netty Server Running&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        boss.shutdownGracefully().sync();</span><br><span class="line">        work.shutdownGracefully().sync();</span><br><span class="line">        log.info(<span class="string">&quot;Netty Server Stop&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyServerHandler</span> <span class="keyword">extends</span> <span class="title class_">ChannelInboundHandlerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (msg <span class="keyword">instanceof</span> MessageBase.Message) &#123;</span><br><span class="line">            <span class="comment">// 将接收到的消息转换为 Protobuf 消息</span></span><br><span class="line">            MessageBase.<span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (MessageBase.Message) msg;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 处理消息（例如，打印消息内容）</span></span><br><span class="line">            log.info(<span class="string">&quot;Received message:&quot;</span>);</span><br><span class="line">            log.info(message.toString());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 可选：根据接收到的消息发送响应</span></span><br><span class="line">            MessageBase.<span class="type">Message</span> <span class="variable">response</span> <span class="operator">=</span> MessageBase.Message.newBuilder()</span><br><span class="line">                    .setRequestId(message.getRequestId())</span><br><span class="line">                    .setCmd(MessageBase.Message.CommandType.ACK)</span><br><span class="line">                    .build();</span><br><span class="line">            ctx.writeAndFlush(response); <span class="comment">// 发送响应</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果接收到的消息不是预期的类型，可以选择忽略或者抛出异常</span></span><br><span class="line">            System.err.println(<span class="string">&quot;Received an unknown message type: &quot;</span> + msg.getClass().getName());</span><br><span class="line">            ctx.fireChannelRead(msg); <span class="comment">// 继续向下传递</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exceptionCaught</span><span class="params">(ChannelHandlerContext ctx, Throwable cause)</span> &#123;</span><br><span class="line">        <span class="comment">// 处理异常</span></span><br><span class="line">        cause.printStackTrace();</span><br><span class="line">        ctx.close(); <span class="comment">// 关闭连接</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyServerHandlerInitializer</span> <span class="keyword">extends</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        ch.pipeline()</span><br><span class="line">                <span class="comment">//空闲检测</span></span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ServerIdleStateHandler</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufVarint32FrameDecoder</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufDecoder</span>(MessageBase.Message.getDefaultInstance()))</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufVarint32LengthFieldPrepender</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufEncoder</span>())</span><br><span class="line">                .addLast(<span class="keyword">new</span> <span class="title class_">NettyServerHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerIdleStateHandler</span> <span class="keyword">extends</span> <span class="title class_">IdleStateHandler</span> &#123;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">times</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置空闲检测时间为 30s</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">READER_IDLE_TIME</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServerIdleStateHandler</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(READER_IDLE_TIME, READER_IDLE_TIME, READER_IDLE_TIME, TimeUnit.SECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelIdle</span><span class="params">(ChannelHandlerContext ctx, IdleStateEvent evt)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125; 秒内没有读取到数据,关闭连接&quot;</span>, READER_IDLE_TIME);</span><br><span class="line"></span><br><span class="line">        System.out.println(ctx.channel().remoteAddress() + <span class="string">&quot;发生超时事件--&quot;</span> + evt);</span><br><span class="line"></span><br><span class="line">        ctx.channel().close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Netty客户端"><a href="#Netty客户端" class="headerlink" title="Netty客户端"></a>Netty客户端</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">EventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">54021</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SocketChannel socketChannel;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span> Netty客户端启动函数 调用Start可以启动对Netty服务端的连接</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> &#125;</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span> yaoHui</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span> 2024/10/11</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">        bootstrap.group(group)</span><br><span class="line">                .channel(NioSocketChannel.class)</span><br><span class="line">                .remoteAddress(host, port)</span><br><span class="line">                .option(ChannelOption.SO_KEEPALIVE, <span class="literal">true</span>)</span><br><span class="line">                .option(ChannelOption.TCP_NODELAY, <span class="literal">true</span>)</span><br><span class="line">                .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                        ch.pipeline()</span><br><span class="line">                                <span class="comment">// 空闲检测</span></span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">IdleStateHandler</span>(<span class="number">60</span>, <span class="number">60</span>, <span class="number">60</span>)) <span class="comment">// 60秒写空闲，30秒读空闲</span></span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">HeartbeatHandler</span>())</span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufVarint32FrameDecoder</span>())</span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufDecoder</span>(MessageBase.Message.getDefaultInstance()))</span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufVarint32LengthFieldPrepender</span>())</span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">ProtobufEncoder</span>())</span><br><span class="line">                                .addLast(<span class="keyword">new</span> <span class="title class_">NettyClientHandler</span>())</span><br><span class="line">                        ; <span class="comment">// 自定义处理器</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="type">ChannelFuture</span> <span class="variable">future</span> <span class="operator">=</span> bootstrap.connect();</span><br><span class="line">        <span class="comment">//客户端断线重连逻辑</span></span><br><span class="line">        future.addListener((ChannelFutureListener) future1 -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (future1.isSuccess()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;连接Netty服务端成功&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                log.info(<span class="string">&quot;连接失败，进行断线重连&quot;</span>);</span><br><span class="line">                future1.channel().eventLoop().schedule(<span class="built_in">this</span>::start, <span class="number">10</span>, TimeUnit.SECONDS);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        socketChannel = (SocketChannel) future.channel();</span><br><span class="line"></span><br><span class="line">        sendMessageThread.setSocketChannel(socketChannel);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="proto文件"><a href="#proto文件" class="headerlink" title="proto文件"></a>proto文件</h3><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//protobuf语法有 proto2和proto3两种，这里指定 proto3</span></span><br><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;</span><br><span class="line"><span class="comment">// 文件选项</span></span><br><span class="line"><span class="keyword">option</span> java_package = <span class="string">&quot;com.fang.screw.client.protocol&quot;</span>;</span><br><span class="line"><span class="keyword">option</span> java_outer_classname = <span class="string">&quot;MessageBase&quot;</span>;</span><br><span class="line"><span class="comment">// 消息模型定义</span></span><br><span class="line"><span class="keyword">message </span><span class="title class_">Message</span> &#123;</span><br><span class="line">  <span class="type">string</span> requestId = <span class="number">1</span>;</span><br><span class="line">  CommandType cmd = <span class="number">2</span>;</span><br><span class="line">  <span class="type">string</span> content = <span class="number">3</span>;</span><br><span class="line">  <span class="type">int32</span> retryCount = <span class="number">4</span>;</span><br><span class="line">  <span class="type">string</span> urlPath = <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">CommandType</span> &#123;</span><br><span class="line">    NORMAL = <span class="number">0</span>; <span class="comment">//常规业务消息</span></span><br><span class="line">    HEARTBEAT_REQUEST = <span class="number">1</span>; <span class="comment">//客户端心跳消息</span></span><br><span class="line">    HEARTBEAT_RESPONSE = <span class="number">2</span>; <span class="comment">//服务端心跳消息</span></span><br><span class="line">    ACK = <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要把Protobuf文件进行编译，具体如何操作请查阅相关资料。</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><h3 id="客户端的心跳包无法传给服务端，但是自行的消息可以发送到服务端"><a href="#客户端的心跳包无法传给服务端，但是自行的消息可以发送到服务端" class="headerlink" title="客户端的心跳包无法传给服务端，但是自行的消息可以发送到服务端"></a>客户端的心跳包无法传给服务端，但是自行的消息可以发送到服务端</h3><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><ul>
<li>客户端的心跳配置错误，导致心跳没有触发；</li>
</ul>
<p>心跳没问题，能够触发，但是消息发不出去了；</p>
<ul>
<li>项目结构存在问题，导致客户端的心跳发送消息存在一定的问题；</li>
</ul>
<p>暂时没找到是什么问题，目前决定取消心跳，在到达一定的空闲时间后就会关闭这个连接，当客户端收到了消息后就会打开链接，然后发送消息。</p>
<p>- </p>
<h2 id="面试问题"><a href="#面试问题" class="headerlink" title="面试问题"></a>面试问题</h2><blockquote>
<p>以下是涵盖整个Netty知识点的面试题，难度循序渐进，共有20个问题：</p>
<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><ol>
<li>什么是Netty，它主要解决了哪些问题？</li>
<li>请简述Netty的工作流程。</li>
<li>Netty的核心组件有哪些？它们各自的作用是什么？</li>
<li>什么是Channel，ChannelHandler和ChannelPipeline，它们之间有什么关系？</li>
<li>Netty中NIO模型是如何工作的？</li>
<li>解释什么是EventLoop以及它的作用。</li>
<li>请描述一下Netty的异步处理模型和事件驱动机制。</li>
</ol>
<h3 id="高级应用"><a href="#高级应用" class="headerlink" title="高级应用"></a>高级应用</h3><ol>
<li>Netty中如何实现TCP连接的管理？如何处理长连接？</li>
<li>如何在Netty中实现心跳机制？心跳机制的作用是什么？</li>
<li>请描述一下Netty的编解码器（Codec），它是如何工作的？</li>
<li>Netty中如何实现SSL&#x2F;TLS加密？</li>
<li>在Netty中，如何处理异常并确保程序的健壮性？</li>
<li>Netty如何支持自定义协议的编解码？</li>
<li>Netty的线程模型是怎样的？如何优化线程池的使用？</li>
</ol>
<h3 id="性能与优化"><a href="#性能与优化" class="headerlink" title="性能与优化"></a>性能与优化</h3><ol>
<li>如何在Netty中实现高并发的处理？有哪些优化措施？</li>
<li>Netty中的内存管理是如何进行的？如何优化内存的使用？</li>
<li>Netty的零拷贝技术是什么，它是如何提高性能的？</li>
<li>如何在Netty中处理大文件上传&#x2F;下载？如何优化性能？</li>
<li>你如何解决Netty中的TCP粘包和拆包问题？</li>
<li>Netty的负载均衡机制是如何实现的？如何保证高可用性？</li>
</ol>
<p>这些问题涉及到Netty的基础使用、架构原理、高级特性、性能优化等各个方面，适用于不同难度层次的面试。</p>
</blockquote>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Netty/">Netty</a></div><div class="post-share"><div class="social-share" data-image="/img/11.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/02/26/69%20%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98/" title="69 面试问题"><img class="cover" src="/img/13.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">69 面试问题</div></div><div class="info-2"><div class="info-item-1">69 面试问题          2024年10月14日面试题B -Tree与B+ Tree的区别（数据结构）  分布式锁（分布式）MVCC（数据库） 索引失效（数据库）order by如何处理get 慢SQL优化（数据库）ok 动态代理（Java）JDK 和 CGLIB AOP失效场景（Java）Spring的AOP失效场景详解 为什么MySQL 2000W数据会导致性能不好，2000w是如何计算出来的呢（数据库） 索引的数据结构（数据库）ok 多表联合查询时大表join小表还是其它（数据库）驱动表与被驱动表：在JOIN操作中，通常有一个驱动表（外层表）和一个被驱动表（内层表）。数据库会从驱动表开始扫描，然后根据JOIN条件在被驱动表中查找匹配的记录。 优先选择小表作为驱动表：一般情况下，将小表作为驱动表，大表作为被驱动表，可以减少扫描次数和内存占用，提高查询性能。 回答错误主要是对SQL的执行流程不清楚，它会先From，然后JOIN...</div></div></div></a><a class="pagination-related" href="/2025/02/26/70%20SpringBoot/" title="70 SpringBoot"><img class="cover" src="/img/19.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">70 SpringBoot</div></div><div class="info-2"><div class="info-item-1">70 SpringBoot参考资料 springBoot常见面试题(2024最新)  谈谈你对SpringBoot的理解SpringBoot是在Spring的基础上开发的，其主要目的是为了简化Spring开发繁多的配置，其采用约定大于配置的理念开发了让开发人员快速开发的框架。让开发人员能够从繁多的配置中解放出来，更多的关注业务。 为什么选择使用SpringBoot在前面我们对SpringBoot理解之后，这个问题很好回答。SpringBoot简化了开发人员繁多的配置，开发效率大幅度提升。解决Maven版本依赖，内置的Tomcat不需要其它外置的Tomcat。 Spring Boot常用注解 @SpringBootApplication： SpringBootConfiguration配置类、componentScan扫描包、EnableAutoConfiguration导入其他配置类 @RestController： @ResponseBody和@Controller的作用。 @Component,@Service,@Controller,@Repository：...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">徐行</div><div class="author-info-description">道阻且长</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fangyaohui"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#68-Netty"><span class="toc-number">1.</span> <span class="toc-text">68 Netty</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.1.</span> <span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">1.2.</span> <span class="toc-text">概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">Netty 核心组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Channel"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">Channel</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EventLoop-%E4%B8%8E-EventLoopGroup"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EventLoop 与 EventLoopGroup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ServerBootstrap-%E4%B8%8E-Bootstrap"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">ServerBootstrap 与 Bootstrap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ChannelHandler-%E4%B8%8E-ChannelPipeline"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">ChannelHandler 与 ChannelPipeline</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ChannelFuture"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">ChannelFuture</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%83%E8%B7%B3"><span class="toc-number">1.2.2.</span> <span class="toc-text">心跳</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">Netty工作原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot%E9%9B%86%E6%88%90Netty"><span class="toc-number">1.4.</span> <span class="toc-text">SpringBoot集成Netty</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#protobuf%E5%8D%8F%E8%AE%AE%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.1.</span> <span class="toc-text">protobuf协议格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5Netty%E4%BE%9D%E8%B5%96"><span class="toc-number">1.4.2.</span> <span class="toc-text">引入Netty依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">1.4.3.</span> <span class="toc-text">Netty服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">1.4.4.</span> <span class="toc-text">Netty客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proto%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.5.</span> <span class="toc-text">proto文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.</span> <span class="toc-text">遇到的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E5%BF%83%E8%B7%B3%E5%8C%85%E6%97%A0%E6%B3%95%E4%BC%A0%E7%BB%99%E6%9C%8D%E5%8A%A1%E7%AB%AF%EF%BC%8C%E4%BD%86%E6%98%AF%E8%87%AA%E8%A1%8C%E7%9A%84%E6%B6%88%E6%81%AF%E5%8F%AF%E4%BB%A5%E5%8F%91%E9%80%81%E5%88%B0%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">1.5.1.</span> <span class="toc-text">客户端的心跳包无法传给服务端，但是自行的消息可以发送到服务端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">思路</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">面试问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.6.1.</span> <span class="toc-text">基础知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8"><span class="toc-number">1.6.2.</span> <span class="toc-text">高级应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E4%B8%8E%E4%BC%98%E5%8C%96"><span class="toc-number">1.6.3.</span> <span class="toc-text">性能与优化</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/28/80-02%20%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%EF%BC%9ABasisFormer%20Attention-based%20Time%20Series%20Forecasting%20with%20Learnable%20and%20Interpretable%20Basis/" title="80-02 BasisFormer:Attention-based Time Series Forecasting with Learnable and Interpretable Basis"><img src="/img/14.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="80-02 BasisFormer:Attention-based Time Series Forecasting with Learnable and Interpretable Basis"/></a><div class="content"><a class="title" href="/2025/02/28/80-02%20%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%EF%BC%9ABasisFormer%20Attention-based%20Time%20Series%20Forecasting%20with%20Learnable%20and%20Interpretable%20Basis/" title="80-02 BasisFormer:Attention-based Time Series Forecasting with Learnable and Interpretable Basis">80-02 BasisFormer:Attention-based Time Series Forecasting with Learnable and Interpretable Basis</a><time datetime="2025-02-28T14:58:17.000Z" title="发表于 2025-02-28 22:58:17">2025-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/28/80-03%20%E6%97%B6%E5%BA%8F%E9%A2%84%E6%B5%8B%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="80-03 时序预测论文阅读笔记"><img src="/img/6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="80-03 时序预测论文阅读笔记"/></a><div class="content"><a class="title" href="/2025/02/28/80-03%20%E6%97%B6%E5%BA%8F%E9%A2%84%E6%B5%8B%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="80-03 时序预测论文阅读笔记">80-03 时序预测论文阅读笔记</a><time datetime="2025-02-28T14:58:17.000Z" title="发表于 2025-02-28 22:58:17">2025-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/28/80-01%20%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%EF%BC%9AAdaptive%20Normalization%20for%20Non-stationary%20Time%20Series%20Forecasting%20A%20Temporal%20Slice%20Perspective%20/" title="80-01 Adaptive Normalization for Non-stationary Time Series Forecasting:A Temporal Slice Perspective"><img src="/img/7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="80-01 Adaptive Normalization for Non-stationary Time Series Forecasting:A Temporal Slice Perspective"/></a><div class="content"><a class="title" href="/2025/02/28/80-01%20%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%EF%BC%9AAdaptive%20Normalization%20for%20Non-stationary%20Time%20Series%20Forecasting%20A%20Temporal%20Slice%20Perspective%20/" title="80-01 Adaptive Normalization for Non-stationary Time Series Forecasting:A Temporal Slice Perspective">80-01 Adaptive Normalization for Non-stationary Time Series Forecasting:A Temporal Slice Perspective</a><time datetime="2025-02-28T13:58:17.000Z" title="发表于 2025-02-28 21:58:17">2025-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/28/75-19%20Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/" title="75-19 Linux文件权限"><img src="/img/20.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="75-19 Linux文件权限"/></a><div class="content"><a class="title" href="/2025/02/28/75-19%20Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/" title="75-19 Linux文件权限">75-19 Linux文件权限</a><time datetime="2025-02-28T10:58:18.000Z" title="发表于 2025-02-28 18:58:18">2025-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/28/79-01%20%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/" title="79-01 装饰器模式"><img src="/img/6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="79-01 装饰器模式"/></a><div class="content"><a class="title" href="/2025/02/28/79-01%20%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/" title="79-01 装饰器模式">79-01 装饰器模式</a><time datetime="2025-02-28T10:58:17.000Z" title="发表于 2025-02-28 18:58:17">2025-02-28</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/index_img.png);"><div id="footer-wrap"><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.3</a></div><div class="footer_custom_text">道阻且长</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>